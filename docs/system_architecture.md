# 作文批改系统 V2.0 架构设计

## 1. 概述

作文批改系统（AutoCorrection V2.0）是一个基于人工智能的作文批改平台，提供智能评分、详细点评和建议改进的在线服务。本文档描述了系统的架构设计和主要功能模块。

## 2. 系统架构

### 2.1 整体架构

系统采用前后端分离的架构，后端基于Flask框架开发，前端使用HTML/CSS/JavaScript构建。系统还包括异步任务处理、实时通知以及数据分析等模块。

```
                  ┌───────────────┐
                  │   Web浏览器   │
                  └───────┬───────┘
                          │
                          ▼
┌────────────────────────────────────────────┐
│             Nginx Web服务器                │
└───────────────────┬────────────────────────┘
                    │
        ┌───────────┴─────────────┐
        │                         │
        ▼                         ▼
┌───────────────┐        ┌─────────────────┐
│Flask Web应用  │◄─────► │WebSocket服务器  │
└───────┬───────┘        └────────┬────────┘
        │                         │
        ▼                         │
┌───────────────┐                 │
│ SQLite数据库  │                 │
└───────────────┘                 │
        ▲                         │
        │                         │
┌───────┴───────┐                 │
│ Celery任务队列│◄────────────────┘
└───────┬───────┘
        │
        ▼
┌───────────────┐
│ Redis后端存储 │
└───────────────┘
        ▲
        │
┌───────┴───────┐
│   AI模型服务  │
└───────────────┘
```

### 2.2 核心组件

系统由以下核心组件构成：

1. **Web应用（Flask）**：提供HTTP API和网页界面
2. **数据库（SQLite）**：存储用户、作文和系统数据
3. **异步任务队列（Celery）**：处理耗时任务，如作文批改
4. **消息代理（Redis）**：支持任务队列和WebSocket通信
5. **WebSocket服务**：提供实时通知功能
6. **AI模型服务**：连接到AI服务提供作文批改能力

### 2.3 目录结构

```
AutoCorrection-V2.0/
├── api/                          # API接口目录
│   ├── __init__.py
│   ├── auth_api.py               # 用户认证API
│   ├── correction_api.py         # 作文批改API
│   ├── membership_api.py         # 会员系统API
│   ├── admin_api.py              # 后台管理API
│   ├── mobile_api.py             # 移动端API
│   └── analytics_api.py          # 数据分析API
├── config/                       # 配置文件目录
│   ├── __init__.py
│   ├── app_config.py             # 应用配置
│   ├── celery_config.py          # Celery任务队列配置
│   ├── logging_config.py         # 日志配置
│   └── models_config.py          # AI模型配置
├── core/                         # 核心业务逻辑
│   ├── __init__.py
│   ├── ai_corrector.py           # AI批改逻辑
│   ├── auth.py                   # 认证核心逻辑
│   ├── correction.py             # 批改服务
│   ├── subscription.py           # 订阅管理
│   ├── payment_processor.py      # 支付处理
│   ├── admin.py                  # 管理功能
│   ├── analytics.py              # 数据分析
│   ├── backup.py                 # 数据备份与恢复
│   ├── user_profile.py           # 用户资料管理
│   └── multilingual.py           # 多语言支持
├── database/                     # 数据库相关
├── services/                     # 外部服务集成
├── scripts/                      # 脚本工具
├── tasks/                        # 异步任务队列
├── utils/                        # 工具函数
├── static/                       # 静态资源
├── templates/                    # 模板文件
└── 其他系统文件和目录...
```

## 3. 主要功能模块

系统包含以下主要功能模块：

### 3.1 用户认证与管理

- 用户注册、登录、注销
- 密码重置和恢复
- 用户信息管理
- 权限控制

### 3.2 作文批改

- 作文提交（同步/异步模式）
- AI智能批改
- 批改结果展示
- 作文历史记录

### 3.3 会员系统

- 会员等级与权限
- 订阅管理
- 支付处理
- 会员特权设置

### 3.4 后台管理

- 用户管理
- 作文管理
- 系统设置
- 数据统计与报表

### 3.5 异步任务处理

- 作文批改异步任务
- 邮件发送任务
- 定期数据处理任务
- 系统维护任务

### 3.6 数据分析

- 用户学习进度分析
- 作文数据统计
- 错误类型分析
- 进步建议生成

### 3.7 实时通知

- WebSocket通信
- 批改状态更新
- 系统通知推送
- 用户消息通知

### 3.8 移动端API

- 移动应用API接口
- 安全认证
- 数据同步
- 离线功能支持

## 4. 技术栈

系统采用以下技术栈：

- **后端框架**：Python Flask
- **数据库**：SQLite
- **ORM**：SQLAlchemy
- **任务队列**：Celery
- **消息代理**：Redis
- **WebSocket**：Flask-SocketIO
- **前端**：HTML/CSS/JavaScript
- **Web服务器**：Nginx + Gunicorn
- **容器化**：Docker & Docker Compose

## 5. 设计原则

系统设计遵循以下原则：

1. **模块化**：系统按功能模块划分，每个模块独立可维护
2. **可扩展性**：架构设计允许轻松添加新功能和模块
3. **异步处理**：耗时操作使用异步任务处理，提高系统响应速度
4. **实时反馈**：通过WebSocket提供实时通知和状态更新
5. **安全性**：实施严格的认证和授权机制，保护用户数据
6. **可维护性**：清晰的代码结构和完善的文档，便于维护

## 6. 系统扩展

系统设计支持以下扩展方向：

1. **移动应用**：预留移动端API接口，支持未来开发移动应用
2. **多语言支持**：可扩展为支持多语言的国际化应用
3. **扩展AI模型**：支持接入不同的AI模型和服务
4. **数据分析增强**：可扩展更复杂的数据分析和可视化功能
5. **教师辅助工具**：可扩展为支持教师使用的批改辅助工具

## 7. 部署架构

系统支持多种部署方式：

1. **开发环境**：使用Flask内置服务器，适合开发测试
2. **生产环境**：Nginx + Gunicorn + Supervisor，适合生产部署
3. **容器化部署**：Docker容器化部署，便于扩展和管理
4. **云服务部署**：可部署至各类云服务平台

## 8. 安全性考虑

系统在设计中考虑了以下安全性因素：

1. **密码安全**：使用bcrypt进行密码哈希存储
2. **会话安全**：采用JWT进行安全认证
3. **数据验证**：严格验证所有用户输入
4. **API安全**：使用令牌认证和权限控制
5. **日志审计**：完整的操作日志记录和审计 